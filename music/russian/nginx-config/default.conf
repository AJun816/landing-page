server {
    listen 80;
    server_name music.htgjai.com;  # 您的实际域名

    # 通用反向代理配置（适用于所有页面）
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_connect_timeout 30s;
    proxy_read_timeout 60s;
    client_max_body_size 10M;  # 限制请求体大小

    # 1. Dreamy 风格页面：访问 /dreamy 路径
    location /dreamy/ {
        # 移除路径前缀 /dreamy/（如 /dreamy/index.html → /index.html）
        rewrite ^/dreamy/(.*)$ /$1 break;
        # 代理到 docker-compose 中的 page-dreamy 服务
        proxy_pass http://page-dreamy:80;
    }

    # 2. Passion 风格页面：访问 /passion 路径
    location /passion/ {
        rewrite ^/passion/(.*)$ /$1 break;
        proxy_pass http://page-passion:80;
    }

    # 3. Tradition 风格页面：访问 /tradition 路径
    location /tradition/ {
        rewrite ^/tradition/(.*)$ /$1 break;
        proxy_pass http://page-tradition:80;
    }

    # 4. Tranquility 风格页面：访问 /tranquility 路径
    location /tranquility/ {
        rewrite ^/tranquility/(.*)$ /$1 break;
        proxy_pass http://page-tranquility:80;
    }

    # 处理不带斜杠的路径（如 /dreamy → 自动补全为 /dreamy/）
    location ~ ^/(dreamy|passion|tradition|tranquility)$ {
        return 301 $scheme://$host$request_uri/;
    }

    # 根路径默认行为：跳转至 Dreamy 风格页面（可自定义）
    location / {
        return 302 /dreamy/;
    }

    # 无效路径返回 404
    error_page 404 /404.html;
    location = /404.html {
        root /usr/share/nginx/html;  # Nginx 容器内的默认静态目录
        internal;
    }
}