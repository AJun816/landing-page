{"ast":null,"code":"import { onMounted, ref, defineAsyncComponent } from 'vue';\nconst loadingTimeout = 5000; // 5秒加载超时\n\n// 预加载背景图 - 使用requestIdleCallback确保不阻塞主渲染\n\nexport default {\n  __name: 'BackgroundDefault',\n  props: {\n    backgroundImage: {\n      type: String,\n      required: true\n    },\n    overlayColor: {\n      type: String,\n      default: 'rgba(0, 0, 0, 0.5)'\n    },\n    overlayOpacity: {\n      type: Number,\n      default: 1\n    }\n  },\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const props = __props;\n\n    // 图片加载状态\n    const imageLoaded = ref(false);\n    const lowQualityPlaceholder = ref(''); // 低质量占位图\n    onMounted(() => {\n      // 对于SVG，我们可以创建一个简单的占位色，因为SVG本身已经很小\n      lowQualityPlaceholder.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxmaWx0ZXIgaWQ9ImEiIHg9IjAiIHk9IjAiPjxmZVR1cmJ1bGVuY2UgdHlwZT0iZnJhY3RhbE5vaXNlIiBiYXNlRnJlcXVlbmN5PSIwLjA1IiBudW1PY3RhdmVzPSIyIiBzdGl0Y2hUaWxlcz0ic3RpdGNoIj48L2ZlVHVyYnVsZW5jZT48ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4wNSAwIj48L2ZlQ29sb3JNYXRyaXg+PC9maWx0ZXI+PGcgZmlsdGVyPSJ1cmwoI2EpIj48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmVlbiI+PC9yZWN0PjwvZz48L3N2Zz4=';\n\n      // 使用requestIdleCallback确保背景图加载不会阻塞页面渲染\n      const loadImage = () => {\n        const img = new Image();\n\n        // 设置加载超时\n        const timeoutId = setTimeout(() => {\n          // 超时后仍然显示背景色，避免白屏\n          imageLoaded.value = true;\n        }, loadingTimeout);\n        img.onload = () => {\n          clearTimeout(timeoutId);\n          imageLoaded.value = true;\n        };\n        img.onerror = () => {\n          clearTimeout(timeoutId);\n          // 加载失败时也显示背景色\n          imageLoaded.value = true;\n        };\n\n        // 设置图片的优先级为低，不影响关键资源加载\n        if ('loading' in img) {\n          img.loading = 'lazy';\n        }\n        img.src = props.backgroundImage;\n      };\n      if ('requestIdleCallback' in window) {\n        window.requestIdleCallback(loadImage);\n      } else {\n        // 降级方案：延迟加载，避免阻塞初始渲染\n        setTimeout(loadImage, 200);\n      }\n    });\n    const __returned__ = {\n      props,\n      imageLoaded,\n      lowQualityPlaceholder,\n      loadingTimeout,\n      onMounted,\n      ref,\n      defineAsyncComponent\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["onMounted","ref","defineAsyncComponent","loadingTimeout","props","__props","imageLoaded","lowQualityPlaceholder","value","loadImage","img","Image","timeoutId","setTimeout","onload","clearTimeout","onerror","loading","src","backgroundImage","window","requestIdleCallback"],"sources":["/Users/ajun/projects/github/landing-page/lotteryDraw/nigeria/src/components/background/BackgroundDefault.vue"],"sourcesContent":["<template>\n  <div class=\"background-container fixed inset-0 z-0\">\n    <!-- 低质量占位图（提高初始加载速度） -->\n    <div \n        v-if=\"lowQualityPlaceholder\"\n        class=\"absolute inset-0 bg-cover bg-center\"\n        :style=\"{\n        backgroundImage: `url(${lowQualityPlaceholder})`,\n        opacity: imageLoaded ? 0 : 1,\n        transition: 'opacity 0.5s ease-out'\n      }\"\n    ></div>\n\n    <!-- 主背景图 -->\n    <div\n        class=\"absolute inset-0 bg-cover bg-center transition-opacity duration-1000\"\n        :style=\"{\n        backgroundImage: `url(${backgroundImage})`,\n        opacity: imageLoaded ? 1 : 0\n      }\"\n    ></div>\n\n    <!-- 背景覆盖层：结合opacity -->\n    <div\n        class=\"absolute inset-0\"\n        :style=\"{\n      backgroundColor: props.overlayColor,\n      opacity: props.overlayOpacity\n    }\"\n    ></div>\n  </div>\n</template>\n\n<script setup>\nimport { onMounted, ref, defineAsyncComponent } from 'vue';\n\nconst props = defineProps({\n  backgroundImage: { type: String, required: true },\n  overlayColor: { type: String, default: 'rgba(0, 0, 0, 0.5)' },\n  overlayOpacity: { type: Number, default: 1 }\n});\n\n// 图片加载状态\nconst imageLoaded = ref(false);\nconst lowQualityPlaceholder = ref(''); // 低质量占位图\nconst loadingTimeout = 5000; // 5秒加载超时\n\n// 预加载背景图 - 使用requestIdleCallback确保不阻塞主渲染\nonMounted(() => {\n  // 对于SVG，我们可以创建一个简单的占位色，因为SVG本身已经很小\n  lowQualityPlaceholder.value = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxmaWx0ZXIgaWQ9ImEiIHg9IjAiIHk9IjAiPjxmZVR1cmJ1bGVuY2UgdHlwZT0iZnJhY3RhbE5vaXNlIiBiYXNlRnJlcXVlbmN5PSIwLjA1IiBudW1PY3RhdmVzPSIyIiBzdGl0Y2hUaWxlcz0ic3RpdGNoIj48L2ZlVHVyYnVsZW5jZT48ZmVDb2xvck1hdHJpeCB0eXBlPSJtYXRyaXgiIHZhbHVlcz0iMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMC4wNSAwIj48L2ZlQ29sb3JNYXRyaXg+PC9maWx0ZXI+PGcgZmlsdGVyPSJ1cmwoI2EpIj48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJncmVlbiI+PC9yZWN0PjwvZz48L3N2Zz4=';\n\n  // 使用requestIdleCallback确保背景图加载不会阻塞页面渲染\n  const loadImage = () => {\n    const img = new Image();\n    \n    // 设置加载超时\n    const timeoutId = setTimeout(() => {\n      // 超时后仍然显示背景色，避免白屏\n      imageLoaded.value = true;\n    }, loadingTimeout);\n    \n    img.onload = () => {\n      clearTimeout(timeoutId);\n      imageLoaded.value = true;\n    };\n    \n    img.onerror = () => {\n      clearTimeout(timeoutId);\n      // 加载失败时也显示背景色\n      imageLoaded.value = true;\n    };\n    \n    // 设置图片的优先级为低，不影响关键资源加载\n    if ('loading' in img) {\n      img.loading = 'lazy';\n    }\n    \n    img.src = props.backgroundImage;\n  };\n\n  if ('requestIdleCallback' in window) {\n    window.requestIdleCallback(loadImage);\n  } else {\n    // 降级方案：延迟加载，避免阻塞初始渲染\n    setTimeout(loadImage, 200);\n  }\n});\n</script>\n\n<style scoped>\n.background-container {\n  pointer-events: none;\n}\n\n/* 确保背景图不会阻止页面的交互 */\n.background-container {\n  will-change: opacity;\n}\n</style>\n\n"],"mappings":"AAkCA,SAASA,SAAS,EAAEC,GAAG,EAAEC,oBAAoB,QAAQ,KAAK;AAW1D,MAAMC,cAAc,GAAG,IAAI,CAAC,CAAC;;AAE7B;;;;;;;;;;;;;;;;;;;;;;IAXA,MAAMC,KAAK,GAAGC,OAIZ;;IAEF;IACA,MAAMC,WAAW,GAAGL,GAAG,CAAC,KAAK,CAAC;IAC9B,MAAMM,qBAAqB,GAAGN,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC;IAIvCD,SAAS,CAAC,MAAM;MACd;MACAO,qBAAqB,CAACC,KAAK,GAAG,ojBAAojB;;MAEllB;MACA,MAAMC,SAAS,GAAGA,CAAA,KAAM;QACtB,MAAMC,GAAG,GAAG,IAAIC,KAAK,CAAC,CAAC;;QAEvB;QACA,MAAMC,SAAS,GAAGC,UAAU,CAAC,MAAM;UACjC;UACAP,WAAW,CAACE,KAAK,GAAG,IAAI;QAC1B,CAAC,EAAEL,cAAc,CAAC;QAElBO,GAAG,CAACI,MAAM,GAAG,MAAM;UACjBC,YAAY,CAACH,SAAS,CAAC;UACvBN,WAAW,CAACE,KAAK,GAAG,IAAI;QAC1B,CAAC;QAEDE,GAAG,CAACM,OAAO,GAAG,MAAM;UAClBD,YAAY,CAACH,SAAS,CAAC;UACvB;UACAN,WAAW,CAACE,KAAK,GAAG,IAAI;QAC1B,CAAC;;QAED;QACA,IAAI,SAAS,IAAIE,GAAG,EAAE;UACpBA,GAAG,CAACO,OAAO,GAAG,MAAM;QACtB;QAEAP,GAAG,CAACQ,GAAG,GAAGd,KAAK,CAACe,eAAe;MACjC,CAAC;MAED,IAAI,qBAAqB,IAAIC,MAAM,EAAE;QACnCA,MAAM,CAACC,mBAAmB,CAACZ,SAAS,CAAC;MACvC,CAAC,MAAM;QACL;QACAI,UAAU,CAACJ,SAAS,EAAE,GAAG,CAAC;MAC5B;IACF,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}